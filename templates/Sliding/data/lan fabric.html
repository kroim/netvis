<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <script src="https://code.jquery.com/jquery-3.5.1.min.js" ></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.7.7/xlsx.core.min.js"></script>  
      <script src="https://cdnjs.cloudflare.com/ajax/libs/xls/0.7.4-a/xls.core.min.js"></script> 

      <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous"> 

      <link href="./bundle.min.css" media="screen" rel="stylesheet" type="text/css">
      <style type="text/css">
         #table{
             border-radius: 5px;
             background-color: #f2f2f2;
             padding: 20px;
         }
      </style>
      <script type="text/javascript"> 

         $( function(){
            //Toggle for parent one//

            $("body").on("click", ".parent1 h2 a", function( e ){
              if(e) e.preventDefault(); 
              if(e.target != this){
               return; 
              }
              $(".endpoint1").slideToggle(); 
            });

            //Toggle for parent Two//

            $("body").on("click", ".parent2 h2 a", function( e ){
              if(e) e.preventDefault(); 
              if(e.target != this){
               return; 
              }
              $(".endpoint2").slideToggle(); 
            });
          
         
           
            //toggleOperation 


            //Toggle for Parent one Child one//
          
              $("body").on("click", ".p1c1", function( e ){
                if(e) e.preventDefault(); 
                if(e.target != this){
                 return; 
                }
                $(".c1").slideToggle(); 
              }); 
          
              //Toggle for Parent one Child Two//

             $("body").on("click", ".p1c2", function( e ){
               if(e) e.preventDefault(); 
               if(e.target != this){
                return; 
               }
               $(".c2").slideToggle(); 
             });         
          
               //Toggle for Parent Two Child One//

             $("body").on("click", ".p2c1", function( e ){
               if(e) e.preventDefault(); 
               if(e.target != this){
                return; 
               }
               $(".c3").slideToggle(); 
             }); 
               
               //Toggle for Paret Two Child Two//

             $("body").on("click", ".p2c2", function( e ){
               if(e) e.preventDefault(); 
               if(e.target != this){
                return; 
               }
               $(".c4").slideToggle(); 
             });

       });

               // Function for hide Child Content when page loads//

           $(document).ready(function(){
              $(".c1,.c2,.c3,.c4").hide();
           });

             // Upload the excel file function for Child1 of Parent 1 //

           $( function(){
              $(".p1c1").click(function () {
                   val = 1;
                   upload_xlsx = "upload-xlsx1";
                   inputs = "#input1";
                   input_ID = 'input1';
                   tables = "#table1";
                   table_ID = "table1";
                   outputs = "#output1";
                   output_ID = "output1";
                   get();        
                  
                   });
               
               // Upload the excel file function for Child2 of Parent 1 // 

                $(".p1c2").click(function () {
                   val = 1;
                   upload_xlsx = "upload-xlsx2";
                   inputs = "#input2";
                   input_ID = "input2";
                   tables = "#table2";
                   table_ID = "table2";
                   outputs = "#output2";
                   output_ID = "output2";
                   get();  
                   
                   });

                // Upload the excel file function for Child1 of Parent 2 //

                $(".p2c1").click(function () {
                   val = 1;
                   upload_xlsx = "upload-xlsx3";
                   inputs = "#input3";
                   input_ID = "input3";
                   tables = "#table3";
                   table_ID = "table3";
                   outputs = "#output3";
                   output_ID = "output3";
                   get();

                   });

                // Upload the excel file function for Child2 of Parent 2 //

                $(".p2c2").click(function () {
                   val = 1;
                   upload_xlsx = "upload-xlsx4";
                   inputs = "#input4";
                   input_ID = "input4";
                   tables = "#table4";
                   table_ID = "table4";
                   outputs = "#output4";
                   output_ID = "output4";
                   get();

                   });

                //Function for print a Excel File Data in Tabular form//

                   function get(){
                     if (val == 1){
                         $("[name=" + upload_xlsx +"]").change(function(){
                         $(inputs).html(""); 
                           ExportToTable(); 
                      });  
                   }

                  }
               });   

           function ExportToTable() {
              var regex = /^([a-zA-Z0-9\s_\\.\-:])+(.xlsx|.xls)$/;
              /*Checks whether the file is a valid excel file*/
              if (regex.test($("[name=" + upload_xlsx +"]").val().toLowerCase())) {
                  var xlsxflag = false; /*Flag for checking whether excel is .xls format or .xlsx format*/
                  if ($("[name=" + upload_xlsx +"]").val().toLowerCase().indexOf(".xlsx") > 0) {
                      xlsxflag = true;
                  }
                  /*Checks whether the browser supports HTML5*/
                  if (typeof (FileReader) != "undefined") {
                      var reader = new FileReader();
                      reader.onload = function (e) {
                          var data = e.target.result;
                          /*Converts the excel data in to object*/
                          if (xlsxflag) {
                              var workbook = XLSX.read(data, { type: 'binary' });
                          }
                          else {
                              var workbook = XLS.read(data, { type: 'binary' });
                          }
                          /*Gets all the sheetnames of excel in to a variable*/
                          var sheet_name_list = workbook.SheetNames;

                          var cnt = 0; /*This is used for restricting the script to consider only first sheet of excel*/
                          sheet_name_list.forEach(function (y) { /*Iterate through all sheets*/
                              /*Convert the cell value to Json*/
                              if (xlsxflag) {
                                  var exceljson = XLSX.utils.sheet_to_json(workbook.Sheets[y]);
                              }
                              else {
                                  var exceljson = XLS.utils.sheet_to_row_object_array(workbook.Sheets[y]);
                              }
                              if (exceljson.length > 0 && cnt == 0) {
                                  BindJqurery(exceljson,inputs);
                                  cnt++;
                              }
                          });
                          $(inputs).hide();
                      }
                      if (xlsxflag) {/*If excel file is .xlsx extension than creates a Array Buffer from excel*/
                          reader.readAsArrayBuffer($("[name=" + upload_xlsx +"]")[0].files[0]);
                      }
                      else {
                          reader.readAsBinaryString($("[name=" + upload_xlsx +"]")[0].files[0]);
                      }
                  }
                  else {
                      alert("Sorry! Your browser does not support HTML5!");
                  }
              }
              else {
                  alert("Please upload a valid Excel file!");
              }
         }

            function BindJqurery(jsondata, dropid) {/*Function used to convert the JSON array to select tag*/

             var count = jsondata.length; 
             
                 var data = "";  
                 var table   = "<table class='table table-bordered table-striped'>";
                     table   += "<tr style='background: ;'>";
                     table   += "<td>Interface</td><td>Name</td><td>type</td>";
                     table   += "</tr>";


                 ;
             $.each(jsondata, function(key, value) {  
                 if( key == (count -1) ){
                   // this is the last colum
                   data += value["interface"]+" "+value["Name"]+" "+value["type"];
                   // if you need add more columns do this here: 
                   //   data += value["interface"]+" "+value["Name"]+" "+value['columnName1']+" "+value['columnName2'];..................
                 } else {
                   // these are other columns
                   data += value["interface"]+" "+value["Name"]+" "+value["type"]+"\n";
                   // if you need add more columns do this here: 
                   //   data += value["interface"]+" "+value["Name"]+" "+value['columnName1']+" "+value['columnName2']+"\n";..................
                 }

                 table +="<tr><td>"+ value["interface"]+"</td><td>"+value["Name"]+"</td><td>"+value["type"]+"</td></tr>"; 
                 // lastly do this to table
                 //table +="<tr><td>"+ value["interface"]+"</td><td>"+value["Name"]+"</td> <td>"+value['your_column_name_here']+"</td> </tr>"; 

                  
             });

             table +="</table>";

             $(tables).html( table );

             $(inputs).html( data );



          } 
          
      </script>
   </head>
   <body>
      <section class="swagger-section" style="overflow:hidden">
      <div id="swagger-ui-container" class="swagger-ui-wrap" data-file="lan fabric.json">
      <ul id="resources">
      <li id="" class="resource"></li>
      <li id="resource_Control_-_Inventory" class="resource">
         <div class="heading parent1" id="p1">
            <h2>
               <a href="" class="parent1">PARENT 1</a> 
            </h2>
         </div>
         <ul class="endpoints endpoint1" id="Control_-_Inventory_endpoint_list" style="">
		 <! -- PARENT1 and Child 1 -->
		 
	<div id="p1c1">	 
      <li class="endpoint">
         <ul class="operations">
            <li class="post operation po1" id="Control_-_Inventory_discoverSwitches">
               <div class="heading">
                  <h3>
                     <span class="http_method">
                     <a href="" class="">CLEAR</a>
                     </span>
                     <span class="path">
                     <a href="" class="p1c1">Child 1</a>
                     </span>
                  </h3>
               </div>
               <div class="content c1" id="" style="">
                  <form accept-charset="UTF-8" class="sandbox">
                     <div style="margin:0;padding:0;display:inline"></div>
                     <table>
                        <tbody class="operation-params">
                           <tr>
                              <td class="code"><label for=""></label></td>
                              <input class="submit" type="file" value="Upload" name="upload-xlsx1" onclick="//process()">
                              <br>
                              <br>
                              <div id="table1"></div>
                              <textarea class="body-textarea" placeholder="EXCEL" id="input1" style="display: none;"></textarea>
                           </tr>
                        </tbody>
                     </table>
                     <table class="fullwidth response-messages">
                        <thead>
                           <tr>
                              <th></th>
                           </tr>
                        </thead>
                     </table>
                     <br>
                     <input class="submit" type="button" value="Generate" onclick="process()">
                     <br>
                     <br>
                     <textarea class="body-textarea" placeholder="OUTPUT" id="output1"></textarea>
                     <br>
                     <br>
                     <table class="fullwidth response-messages">
                        <thead>
                           <tr>
                              <th></th>
                           </tr>
                        </thead>
                     </table>
                     <br>
                     <input class="parameter required" placeholder="Username" id="ogn">
                     <br>
                     <br>
                     <input class="parameter required" placeholder="Password" id="ogn">
                     <br>
                     <br>
                     <input class="submit" type="button" value="Token" onclick="process()">
                     &nbsp;
                     <input class="parameter required" placeholder="Blank Token" id="ogn">
                     <br>
                     <br>
                     <input class="submit" type="button" value="API CALL PUSH" onclick="process()">
                  </form>
               </div>
            </li>
         </ul>
      </li>
	  </div>
	  
	  <! -- PARENT1 and Child 2 -->
      <li class="endpoint child2">
         <ul class="operations">
            <li class="post operation po2" id="Control_-_Inventory_discoverSwitches">
               <div class="heading">
                  <h3>
                     <span class="http_method">
                     <a href="" class="">CLEAR</a>
                     </span>
                     <span class="path">
                     <a href="" class="p1c2">Child 2</a>
                     </span>
                  </h3>
               </div>
               <div class="content c2" id="" style="">
                  <form accept-charset="UTF-8" class="sandbox">
                     <div style="margin:0;padding:0;display:inline"></div>
                     <table>
                        <tbody class="operation-params">
                           <tr>
                              <td class="code"><label for=""></label></td>
                              <input class="submit" type="file" value="Upload" name="upload-xlsx2" onclick="//process()">
                              <br>
                              <br>
                              <div id="table2"></div>
                              <textarea class="body-textarea" placeholder="EXCEL" id="input2" style="display: none;"></textarea>
                           </tr>
                        </tbody>
                     </table>
                     <table class="fullwidth response-messages">
                        <thead>
                           <tr>
                              <th></th>
                           </tr>
                        </thead>
                     </table>
                     <br>
                     <input class="submit" type="button" value="Generate" onclick="process()">
                     <br>
                     <br>
                     <textarea class="body-textarea" placeholder="OUTPUT" id="output2"></textarea>
                     <br>
                     <br>
                     <table class="fullwidth response-messages">
                        <thead>
                           <tr>
                              <th></th>
                           </tr>
                        </thead>
                     </table>
                     <br>
                     <input class="parameter required" placeholder="Username" id="ogn">
                     <br>
                     <br>
                     <input class="parameter required" placeholder="Password" id="ogn">
                     <br>
                     <br>
                     <input class="submit" type="button" value="Token" onclick="process()">
                     &nbsp;
                     <input class="parameter required" placeholder="Blank Token" id="ogn">
                     <br>
                     <br>
                     <input class="submit" type="button" value="API CALL PUSH" onclick="process()">
                  </form>
               </div>
            </li>
         </ul>
      </li>	   
    </ul>
  </li>
</ul>
<ul id="resources">
      <li id="" class="resource"></li>
      <li id="resource_Control_-_Inventory" class="resource">
         <div class="heading parent2">
            <h2>
               <a href="">PARENT 2</a> 
            </h2>
         </div>
         <ul class="endpoints endpoint2" id="Control_-_Inventory_endpoint_list" style="">
       <! -- PARENT2 and Child 1 -->
      <li class="endpoint">
         <ul class="operations">
            <li class="post operation po3" id="Control_-_Inventory_discoverSwitches">
               <div class="heading">
                  <h3>
                     <span class="http_method">
                     <a href="" class="">CLEAR</a>
                     </span>
                     <span class="path">
                     <a href="" class="p2c1">Child 1</a>
                     </span>
                  </h3>
               </div>
               <div class="content c3" id="" style="">
                  <form accept-charset="UTF-8" class="sandbox">
                     <div style="margin:0;padding:0;display:inline"></div>
                     <table>
                        <tbody class="operation-params">
                           <tr>
                              <td class="code"><label for=""></label></td>
                              <input class="submit" type="file" value="Upload" name="upload-xlsx3" onclick="//process()">
                              <br>
                              <br>
                              <div id="table3"></div>
                              <textarea class="body-textarea" placeholder="EXCEL" id="input3" style="display: none;"></textarea>
                           </tr>
                        </tbody>
                     </table>
                     <table class="fullwidth response-messages">
                        <thead>
                           <tr>
                              <th></th>
                           </tr>
                        </thead>
                     </table>
                     <br>
                     <input class="submit" type="button" value="Generate" onclick="process()">
                     <br>
                     <br>
                     <textarea class="body-textarea" placeholder="OUTPUT" id="output3"></textarea>
                     <br>
                     <br>
                     <table class="fullwidth response-messages">
                        <thead>
                           <tr>
                              <th></th>
                           </tr>
                        </thead>
                     </table>
                     <br>
                     <input class="parameter required" placeholder="Username" id="ogn">
                     <br>
                     <br>
                     <input class="parameter required" placeholder="Password" id="ogn">
                     <br>
                     <br>
                     <input class="submit" type="button" value="Token" onclick="process()">
                     &nbsp;
                     <input class="parameter required" placeholder="Blank Token" id="ogn">
                     <br>
                     <br>
                     <input class="submit" type="button" value="API CALL PUSH" onclick="process()">
                  </form>
               </div>
            </li>
         </ul>
      </li>   

       <! -- PARENT2 and Child 2 -->
      <li class="endpoint">
         <ul class="operations">
            <li class="post operation po4" id="Control_-_Inventory_discoverSwitches">
               <div class="heading">
                  <h3>
                     <span class="http_method">
                     <a href="" class="">CLEAR</a>
                     </span>
                     <span class="path">
                     <a href="" class="p2c2">Child 2</a>
                     </span>
                  </h3>
               </div>
               <div class="content c4" id="" style="">
                  <form accept-charset="UTF-8" class="sandbox">
                     <div style="margin:0;padding:0;display:inline"></div>
                     <table>
                        <tbody class="operation-params">
                           <tr>
                              <td class="code"><label for=""></label></td>
                              <input class="submit" type="file" value="Upload" name="upload-xlsx4" onclick="//process()">
                              <br>
                              <br>
                              <div id="table4"></div>
                              <textarea class="body-textarea" placeholder="EXCEL" id="input4" style="display: none;"></textarea>
                           </tr>
                        </tbody>
                     </table>
                     <table class="fullwidth response-messages">
                        <thead>
                           <tr>
                              <th></th>
                           </tr>
                        </thead>
                     </table>
                     <br>
                     <input class="submit" type="button" value="Generate" onclick="process()">
                     <br>
                     <br>
                     <textarea class="body-textarea" placeholder="OUTPUT" id="output4"></textarea>
                     <br>
                     <br>
                     <table class="fullwidth response-messages">
                        <thead>
                           <tr>
                              <th></th>
                           </tr>
                        </thead>
                     </table>
                     <br>
                     <input class="parameter required" placeholder="Username" id="ogn">
                     <br>
                     <br>
                     <input class="parameter required" placeholder="Password" id="ogn">
                     <br>
                     <br>
                     <input class="submit" type="button" value="Token" onclick="process()">
                     &nbsp;
                     <input class="parameter required" placeholder="Blank Token" id="ogn">
                     <br>
                     <br>
                     <input class="submit" type="button" value="API CALL PUSH" onclick="process()">
                  </form>
               </div>
            </li>
         </ul>
      </li>      
     </ul>
   </li>
</ul>
</div>
</section>

	  
<script type="text/javascript">
  function process(){
       var html="{\r\n";
       html+="        \"policy\": \"int_access_host_11_1\",\r\n";
       html+="        \"interfaces\": [\r\n"; 
       var input=document.getElementById(input_ID).value;
       var splitt=input.split("\n");
       for(var i=0;i<splitt.length;i++){
         var splittt=splitt[i].split("\t");
         if(splittt.length==1)
           splittt=splitt[i].split(" ");
         var name=splittt[1];
         var vlan=splittt[0];
         html+=gethtml(name,vlan);
         if(i<splitt.length-1)
           html+=",";
         console.log(html);
       }
     html+="        ]\r\n";
       html+="    }\r\n";  
       document.getElementById(output_ID).value=html;
  }

  function gethtml(name,vlan){
      var html="";
      html+="    {\r\n";
      html+="        \"serialNumber\": \"SAL2035UU2F\",\r\n";
      html+="        \"interfaceType\": \"INTERFACE_ETHERNET\",\r\n";
      html+="        \"ifName\": \""+vlan+"\",\r\n";
      html+="        \"fabricName\": \"DFW-SV7-CER\",\r\n";
      html+="        \"nvPairs\": {\r\n";
      html+="            \"BPDUGUARD_ENABLED\": \"no\",\r\n";
      html+="            \"PORTTYPE_FAST_ENABLED\": true,\r\n";
      html+="            \"MTU\": \"jumbo\",\r\n";
      html+="            \"SPEED\": \"Auto\",\r\n";
      html+="            \"ACCESS_VLAN\": \"3600\",\r\n";
      html+="            \"DESC\": \""+name+"\",\r\n";
      html+="            \"CONF\": \"\",\r\n";
      html+="            \"ADMIN_STATE\": true,\r\n";
      html+="            \"INTF_NAME\": \""+vlan+"\"\r\n";
      html+="        }\r\n";
      html+="    }\r\n";
      return html;
 }
  
</script>	

   </body>
</html>